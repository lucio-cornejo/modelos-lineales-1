{
  "hash": "d0f15c48bdd7ff794099be9e2d7860e2",
  "result": {
    "engine": "knitr",
    "markdown": "# Lista de ejercicios {-}\n\n## Exercise 2\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n:::\n\n\n\n\n\n### Item a\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatos_str <- \"\nTrabajador,Semana,Turno,Indice\n1,1,Día,51\n1,2,Día,54\n1,3,Día,59\n1,4,Día,58\n2,1,Día,52\n2,2,Día,56\n2,3,Día,57\n2,4,Día,55\n3,1,Noche,55\n3,2,Noche,57\n3,3,Noche,68\n4,1,Noche,58\n4,2,Noche,59\n4,3,Noche,60\n4,4,Noche,74\n5,1,Día,52\n5,2,Día,54\n5,3,Día,57\n5,4,Día,57\n\"\n\ndatos <- read.table(text = datos_str, header = TRUE, sep = ',') |>\n  dplyr::mutate(Noche = Turno == 'Noche')\n\ndatos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Trabajador Semana Turno Indice Noche\n1           1      1   Día     51 FALSE\n2           1      2   Día     54 FALSE\n3           1      3   Día     59 FALSE\n4           1      4   Día     58 FALSE\n5           2      1   Día     52 FALSE\n6           2      2   Día     56 FALSE\n7           2      3   Día     57 FALSE\n8           2      4   Día     55 FALSE\n9           3      1 Noche     55  TRUE\n10          3      2 Noche     57  TRUE\n11          3      3 Noche     68  TRUE\n12          4      1 Noche     58  TRUE\n13          4      2 Noche     59  TRUE\n14          4      3 Noche     60  TRUE\n15          4      4 Noche     74  TRUE\n16          5      1   Día     52 FALSE\n17          5      2   Día     54 FALSE\n18          5      3   Día     57 FALSE\n19          5      4   Día     57 FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelo <- lm(Indice ~ Noche, data = datos)\nlmtest::bptest(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  modelo\nBP = 4.3902, df = 1, p-value = 0.03615\n```\n\n\n:::\n:::\n\n\n\n\n\n### Item b\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlmtest::dwtest(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDurbin-Watson test\n\ndata:  modelo\nDW = 2.2855, p-value = 0.6661\nalternative hypothesis: true autocorrelation is greater than 0\n```\n\n\n:::\n:::\n\n\n\n\n\n### Item c\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nlme)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'nlme'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    collapse\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_ols <- lm(Indice ~ Noche, data = datos)\nsummary(modelo_ols)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Indice ~ Noche, data = datos)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-6.571 -3.167 -1.167  1.833 12.429 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   55.167      1.320  41.797  < 2e-16 ***\nNocheTRUE      6.405      2.175   2.945  0.00905 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.572 on 17 degrees of freedom\nMultiple R-squared:  0.3379,\tAdjusted R-squared:  0.2989 \nF-statistic: 8.675 on 1 and 17 DF,  p-value: 0.009048\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_wsl <- gls(\n  Indice ~ Noche,\n  data = datos,\n  weights = varIdent(form = ~ 1 | Noche),\n  method = \"ML\"\n)\nsummary(modelo_wsl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized least squares fit by maximum likelihood\n  Model: Indice ~ Noche \n  Data: datos \n       AIC     BIC    logLik\n  109.5603 113.338 -50.78014\n\nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | Noche \n Parameter estimates:\n   FALSE     TRUE \n1.000000 2.560416 \n\nCoefficients:\n               Value Std.Error  t-value p-value\n(Intercept) 55.16667 0.7561476 72.95753  0.0000\nNocheTRUE    6.40476 2.6452628  2.42122  0.0269\n\n Correlation: \n          (Intr)\nNocheTRUE -0.286\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-1.6816820 -0.6417877 -0.2477075  0.7399401  1.9591415 \n\nResidual standard error: 2.477678 \nDegrees of freedom: 19 total; 17 residual\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_ar1 <- gls(\n  Indice ~ Noche,\n  data = datos,\n  correlation = corAR1(form = ~ 1),\n  method = \"ML\"\n)\nsummary(modelo_ar1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized least squares fit by maximum likelihood\n  Model: Indice ~ Noche \n  Data: datos \n     AIC      BIC    logLik\n  116.96 120.7377 -54.47998\n\nCorrelation Structure: AR(1)\n Formula: ~1 \n Parameter estimate(s):\n       Phi \n-0.1813535 \n\nCoefficients:\n               Value Std.Error  t-value p-value\n(Intercept) 55.30660  1.126014 49.11717  0.0000\nNocheTRUE    6.08224  1.875208  3.24350  0.0048\n\n Correlation: \n          (Intr)\nNocheTRUE -0.624\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-1.4773996 -0.7646418 -0.3021482  0.3915922  2.9162897 \n\nResidual standard error: 4.324384 \nDegrees of freedom: 19 total; 17 residual\n```\n\n\n:::\n:::\n\n\n\n\n\n### Item d\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(modelo_ols, modelo_wsl, modelo_ar1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           df      AIC\nmodelo_ols  3 115.5659\nmodelo_wsl  4 109.5603\nmodelo_ar1  4 116.9600\n```\n\n\n:::\n:::\n\n\n\n\n\nComparamos los modelos por medio de AIC.\nAsí, escogemos el modelo con menor AIC, ergo: **WSL**\n\n### Item e\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresid(modelo_wsl, type = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          1           2           3           4           5           6 \n-1.68168198 -0.47087095  1.54714742  1.14354374 -1.27807830  0.33633640 \n          7           8           9          10          11          12 \n 0.73994007 -0.06726728 -1.03586791 -0.72060377  1.01334905 -0.56297169 \n         13          14          15          16          17          18 \n-0.40533962 -0.24770754  1.95914149 -1.27807830 -0.47087095  0.73994007 \n         19 \n 0.73994007 \nattr(,\"std\")\n   FALSE    FALSE    FALSE    FALSE    FALSE    FALSE    FALSE    FALSE \n2.477678 2.477678 2.477678 2.477678 2.477678 2.477678 2.477678 2.477678 \n    TRUE     TRUE     TRUE     TRUE     TRUE     TRUE     TRUE    FALSE \n6.343887 6.343887 6.343887 6.343887 6.343887 6.343887 6.343887 2.477678 \n   FALSE    FALSE    FALSE \n2.477678 2.477678 2.477678 \nattr(,\"label\")\n[1] \"Standardized residuals\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Residuos estandarizados del modelo OLS\nresid_ols_std <- rstandard(modelo_ols)\n\n# Residuos estandarizados (tipo Pearson) del modelo ponderado\nresid_wsl_std <- resid(modelo_wsl, type = \"pearson\")\n\n# Plot base comparativo\nplot(\n  resid_ols_std, resid_wsl_std,\n  col = \"purple\", pch = 16,\n  xlab = \"Residuos estandarizados (OLS)\",\n  ylab = \"Residuos estandarizados (WSL)\",\n  main = \"Comparación de residuos estandarizados: OLS vs. WSL\",\n)\nabline(0, 1, col = \"gray\", lty = 2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Residuos estandarizados\nresid_ols_std <- rstandard(modelo_ols)\nresid_wsl_std <- resid(modelo_wsl, type = \"pearson\")\n\n# Coordenada x: 0 si Día, 1 si Noche\nx_vals <- as.numeric(datos$Noche)\n\n# Graficar los residuos OLS\nplot(\n  x_vals, resid_ols_std,\n  col = rgb(1, 0, 0, 0.6), pch = 16,\n  xlab = \"Turno (0 = Día, 1 = Noche)\",\n  ylab = \"Residuos estandarizados\",\n  main = \"Residuos estandarizados: OLS (rojo) vs WSL (azul)\",\n  ylim = range(c(resid_ols_std, resid_wsl_std))\n)\n\n# Agregar residuos WSL en azul\npoints(\n  x_vals, resid_wsl_std,\n  col = rgb(0, 0, 1, 0.6), pch = 17\n)\n\n# Leyenda\nlegend(\n  \"topright\",\n  legend = c(\"OLS\", \"WSL\"),\n  col = c(\"red\", \"blue\"),\n  pch = c(16, 17),\n  bty = \"n\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
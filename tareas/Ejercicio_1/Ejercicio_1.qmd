---
title: "Eggs"
author: "Sergio Camiz"
date: today
format: html
editor:
  markdown:
    wrap: 120
---

<!-- ---
title: "Eggs"
author: "Sergio Camiz"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  markdown: 
    wrap: 120
--- -->


## Ejemplo de lectura de datos


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width = 300)
library(readODS)
```

En la primera ejecución de este documento, no existe el archivo `Eggs.csv`, por lo cual deshabilitamos su carga.

```{r}
#| label: read_data
#| eval: false
eggs <- read.csv("Eggs.csv", header=TRUE,row.names=1)             # lectura datos
head(eggs)                                                        # control
str(eggs)                                                         # estructura data-frame
print(eggs)
```


Cargamos los datos del arhivo `Eggsorg.ods`.

```{r}
#| label: read_data_1
eggs <- read_ods("Eggsorg.ods", sheet = 1)                        # lectura datos
head(eggs)                                                        # control
str(eggs)                                                         # estructura data-frame
```

Resulta necesario indicar que la columna `Name` debe considerarse una etiqueta de fila.
Además, la variable `eggs` debe ser de tipo `data.frame`, no `tibble`.


```{r}
#| label: read_data_2
# Lectura con etiquetas
eggs <- read_ods("Eggsorg.ods", sheet = 1, row_names = TRUE, as_tibble = FALSE) 
head(eggs)
str(eggs)

# Escritura .csv
write.csv(eggs, file = "Eggs.csv")                              
```

Removemos los espacios extra al inicio y final de cada etiqueta de fila y columna.

```{r}
#| label: read_data_3
rownames(eggs) <- trimws(rownames(eggs), which = c("both"))     
colnames(eggs)

colnames(eggs) <- c(
  "Family", "Size", "Nesting ground", "Eggs",
  "Length", "Width", "Mass", "Hatch"
)
print(eggs)                                  

write_ods(
  eggs, 
  "Eggs.ods", 
  # Nueva hoja
  sheet = "Data",                     
  row_names = TRUE, 
  col_names = TRUE
)

# Reescribimos el archivo .csv, ahora correcto
write.csv(eggs, file = "Eggs.csv")
```
